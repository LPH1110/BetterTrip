{"ast":null,"code":"const axios = require('axios');\n\nconst dayjs = require('dayjs');\n\nconst customParseFormat = require('dayjs/plugin/customParseFormat');\n\nconst FlightFare = require(\"./FlightFare\");\n\ndayjs.extend(customParseFormat);\n\nclass Airline {\n  constructor(name) {\n    this.name = name;\n    this.fares = [];\n  }\n\n  getFares(departure, destination) {\n    console.log(`- Getting flight from ${this.name}`);\n  }\n\n}\n\nclass Red extends Airline {\n  getFares(departure, destination) {\n    super.getFares(departure, destination);\n    return new Promise(async (resolve, reject) => {\n      const fromDate = dayjs().startOf('month').format('YYYY-MM-DD');\n      const mainUrl = 'https://k.airasia.com/availabledates/api/v1/pricecalendar';\n      const url = `${mainUrl}/0/0/THB/${departure}/${destination}/${fromDate}/1/16`;\n\n      try {\n        const res = await axios.get(url);\n        const dataKey = `${departure}${destination}|THB`;\n        const data = res.data;\n        const result = Object.keys(data[dataKey]).map(key => {\n          const keyDate = dayjs(key, 'YYYY-MM-DD');\n          const date = keyDate.format('DD/MM/YYYY');\n          const day = keyDate.format('ddd');\n          const fare = data[dataKey][key];\n          return new FlightFare(date, day, fare, 'RED');\n        });\n        this.fares = result;\n        resolve(result);\n      } catch (error) {\n        console.error(error);\n        reject(error);\n      }\n    });\n  }\n\n}\n\nclass Yellow extends Airline {\n  getFares(departure, destination) {\n    super.getFares(departure, destination);\n    return new Promise(async (resolve, reject) => {\n      const fromDate = dayjs().startOf('month').format('MM/DD/YYYY');\n      const toDate = dayjs().add(1, 'year').format('MM/DD/YYYY');\n      const mainUrl = 'https://www.nokair.com/Flight/GetCalendarFare';\n      const url = `${mainUrl}?from=${departure}&to=${destination}&fromDate=${fromDate}&toDate=${toDate}&currency=THB`;\n\n      try {\n        const res = await axios.get(url);\n        const result = res.data.map(item => {\n          const itemDate = dayjs(item.dateKey, 'YYYYMMDD');\n          const date = itemDate.format('DD/MM/YYYY');\n          const day = itemDate.format('ddd');\n          const fare = parseFloat(item.amount.replace(',', ''));\n          return new FlightFare(date, day, fare, 'YELLOW');\n        });\n        this.fares = result;\n        resolve(result);\n      } catch (error) {\n        console.error(error);\n        reject(error);\n      }\n    });\n  }\n\n}\n\nmodule.exports = {\n  Red,\n  Yellow\n};","map":{"version":3,"names":["axios","require","dayjs","customParseFormat","FlightFare","extend","Airline","constructor","name","fares","getFares","departure","destination","console","log","Red","Promise","resolve","reject","fromDate","startOf","format","mainUrl","url","res","get","dataKey","data","result","Object","keys","map","key","keyDate","date","day","fare","error","Yellow","toDate","add","item","itemDate","dateKey","parseFloat","amount","replace","module","exports"],"sources":["D:/BetterTrip-main/client/src/pages/Flight/Airline.js"],"sourcesContent":["const axios = require('axios');\r\nconst dayjs = require('dayjs');\r\nconst customParseFormat = require('dayjs/plugin/customParseFormat');\r\nconst FlightFare = require('./FlightFare');\r\n\r\ndayjs.extend(customParseFormat);\r\n\r\nclass Airline {\r\n  constructor(name) {\r\n    this.name = name;\r\n    this.fares = [];\r\n  }\r\n\r\n  getFares(departure, destination) {\r\n    console.log(`- Getting flight from ${this.name}`);\r\n  }\r\n}\r\n\r\nclass Red extends Airline {\r\n  getFares(departure, destination) {\r\n    super.getFares(departure, destination);\r\n    return new Promise(async (resolve, reject) => {\r\n      const fromDate = dayjs().startOf('month').format('YYYY-MM-DD');\r\n      const mainUrl =\r\n        'https://k.airasia.com/availabledates/api/v1/pricecalendar';\r\n      const url = `${mainUrl}/0/0/THB/${departure}/${destination}/${fromDate}/1/16`;\r\n      try {\r\n        const res = await axios.get(url);\r\n        const dataKey = `${departure}${destination}|THB`;\r\n        const data = res.data;\r\n        const result = Object.keys(data[dataKey]).map((key) => {\r\n          const keyDate = dayjs(key, 'YYYY-MM-DD');\r\n          const date = keyDate.format('DD/MM/YYYY');\r\n          const day = keyDate.format('ddd');\r\n          const fare = data[dataKey][key];\r\n          return new FlightFare(date, day, fare, 'RED');\r\n        });\r\n        this.fares = result;\r\n        resolve(result);\r\n      } catch (error) {\r\n        console.error(error);\r\n        reject(error);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nclass Yellow extends Airline {\r\n  getFares(departure, destination) {\r\n    super.getFares(departure, destination);\r\n    return new Promise(async (resolve, reject) => {\r\n      const fromDate = dayjs().startOf('month').format('MM/DD/YYYY');\r\n      const toDate = dayjs().add(1, 'year').format('MM/DD/YYYY');\r\n      const mainUrl = 'https://www.nokair.com/Flight/GetCalendarFare';\r\n      const url = `${mainUrl}?from=${departure}&to=${destination}&fromDate=${fromDate}&toDate=${toDate}&currency=THB`;\r\n      try {\r\n        const res = await axios.get(url);\r\n        const result = res.data.map((item) => {\r\n          const itemDate = dayjs(item.dateKey, 'YYYYMMDD');\r\n          const date = itemDate.format('DD/MM/YYYY');\r\n          const day = itemDate.format('ddd');\r\n          const fare = parseFloat(item.amount.replace(',', ''));\r\n          return new FlightFare(date, day, fare, 'YELLOW');\r\n        });\r\n        this.fares = result;\r\n        resolve(result);\r\n      } catch (error) {\r\n        console.error(error);\r\n        reject(error);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = { Red, Yellow };"],"mappings":"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"},"metadata":{},"sourceType":"module"}